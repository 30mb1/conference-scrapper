
<!DOCTYPE html>
<html>
<head>
  <title>SRS project | Graph visualization</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>

  <script type="text/javascript">
    const graphData = {
      nodes: {{ conf_list | safe }},
      edges: {{ edge_list | safe }},
    };

    class GraphConnector {
      static node([x, y, id, meta]) {
        return {
          // x: x * 10000,
          // y: y * 10000,
          id,
          value: meta.degree * 10,
          label: meta.title,
        };
      }

      static edge([from, to, weight, meta]) {
        return {
          from,
          to,
          value: weight,
        }
      }
    }

    class Graph {
      constructor({ nodes, edges }) {
        this.rawNodes = nodes || [];
        this.rawEdges = edges || [];
      }

      nodes() {
        return this.rawNodes.map(n => GraphConnector.node(n));
      }

      edges() {
        return this.rawEdges.map(e => GraphConnector.edge(e));
      }
    }
  </script>

  <style type="text/css">
    #graph {
      width: 100%;
      height: 75vh;
      border: 1px solid lightgray;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container">
    <!-- Header -->
    <div class="py-5 text-center">
      <h2>Graph visualization</h2>
      <p class="lead">Feel free to zoom and drag & drop graph! Large graph may render for a while, so please - be patient :)</p>
    </div>
    <!-- Header end -->

    <!-- Graph -->
    <div id="graph"></div>
    <!-- Graph end -->
  </div>

  <!-- Graph logic -->
  <script type="text/javascript">
    const container = document.getElementById('graph');
    const g = new Graph(graphData);

    const data = {
      nodes: new vis.DataSet(g.nodes()),
      edges: new vis.DataSet(g.edges()),
    };

    const options = {
      layout: {
        randomSeed: 1,
        improvedLayout: false,
        // hierarchical: {
        //   direction: 'LR',
        //   sortMethod: 'directed',
        // },
      },
      physics: {
        stabilization: {
          iterations: 1000,
        }
      },
      interaction: {
        dragNodes: false,        
      },
      nodes: {
        color: '#6A1B9A',
        shape: 'dot',
        scaling:{
          label: {
            min: 2,
            max: 20,
          },
        },
      },
      edges: {
        color : {
          inherit: false,
          color: '#F9A825',
        },
        smooth: {
          enabled: false,
        },
      },
    };

    const network = new vis.Network(container, data, options);

    // TODO: button increse node size
  </script>
  <!-- Graph logic end -->
</body>
</html>